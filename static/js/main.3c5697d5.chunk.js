(this.webpackJsonptaa=this.webpackJsonptaa||[]).push([[1],{114:function(e,t,n){"use strict";(function(e){var s=n(4),a=n.n(s),r=n(10),i=n(6),o=n(7),c=n(8),l=n(9),u=n(1),p=n.n(u),d=n(2),h=n(22),j=n(5),f=n(13),b=(n(207),n(63)),m=n(0),g=function(t){Object(c.a)(s,t);var n=Object(l.a)(s);function s(e){var t;return Object(i.a)(this,s),(t=n.call(this,e)).reportText="",t.state={dataDownloadRatio:0,showUpdateDataDone:!1,showBugReportAlert:!1,showClearAlert:!1,showToast:!1,toastMessage:""},t}return Object(o.a)(s,[{key:"ionViewWillEnter",value:function(){}},{key:"updateOfflineData",value:function(){var e=Object(r.a)(a.a.mark((function e(){var t,n,s=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dataDownloadRatio:0}),e.next=3,j.a.downloadData(j.a.dataUrl,(function(e){s.setState({dataDownloadRatio:e/100})}));case 3:t=e.sent,n=JSON.parse(t.toString()),j.a.saveFileToIndexedDB(j.a.animalsKey,n),this.setState({dataDownloadRatio:1,showUpdateDataDone:!0});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(m.jsxs)(d.s,{children:[Object(m.jsx)(d.e,{children:Object(m.jsx)(d.I,{children:Object(m.jsx)(d.F,{className:"uiFont",children:"\u8a2d\u5b9a"})})}),Object(m.jsxs)(d.d,{children:[Object(m.jsxs)(d.p,{children:[Object(m.jsxs)(d.k,{hidden:j.a.isMac(),children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.x,slot:"start"}),Object(m.jsxs)(d.o,{className:"ion-text-wrap uiFont",onClick:function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:["App \u7248\u672c: ",Object(m.jsx)("a",{href:"https://github.com/MrMYHuang/taa#history",target:"_blank",rel:"noreferrer",children:b.pwaVersion})]}),Object(m.jsx)(d.c,{fill:"outline",shape:"round",slot:"end",size:"large",className:"uiFont",onClick:function(e){t.props.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!0,text:window.location.origin}})},children:"\u5206\u4eab"})]}),Object(m.jsxs)(d.k,{hidden:!this.props.mainVersion||j.a.isMac(),children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.n,slot:"start"}),Object(m.jsxs)(d.o,{className:"ion-text-wrap uiFont",children:["Backend app\u7248\u672c: ",this.props.mainVersion]})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.d,slot:"start"}),Object(m.jsx)(d.o,{className:"ion-text-wrap uiFont",children:"\u555f\u7528 app \u7570\u5e38\u8a18\u9304"}),Object(m.jsx)(d.H,{slot:"end",checked:this.props.hasAppLog,onIonChange:function(e){var n=e.detail.checked;t.props.hasAppLog!==n&&(n?j.a.enableAppLog():j.a.disableAppLog(),t.props.dispatch({type:"SET_KEY_VAL",key:"hasAppLog",val:n}))}})]}),Object(m.jsxs)(d.k,{hidden:!this.props.settings.hasAppLog,children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.d,slot:"start"}),Object(m.jsx)(d.o,{className:"ion-text-wrap uiFont",children:"\u56de\u5831 app \u7570\u5e38\u8a18\u9304"}),Object(m.jsx)(d.c,{fill:"outline",shape:"round",slot:"end",size:"large",className:"uiFont",onClick:function(e){t.reportText="\u700f\u89bd\u5668\uff1a"+navigator.userAgent+"\n\nApp\u7248\u672c\uff1a"+b.pwaVersion+"\n\nApp\u8a2d\u5b9a\uff1a"+JSON.stringify(t.props.settings)+"\n\nLog\uff1a\n"+j.a.getLog(),t.setState({showBugReportAlert:!0})},children:"\u56de\u5831"}),Object(m.jsx)(d.a,{cssClass:"uiFont",backdropDismiss:!1,isOpen:this.state.showBugReportAlert,header:"\u7570\u5e38\u56de\u5831",subHeader:"\u8f38\u5165\u60a8\u7684 E-mail\uff0c\u4ee5\u5f8c\u7e8c\u806f\u7d61",inputs:[{name:"name0",type:"email",placeholder:"\u4f8b\uff1aabc@example.com"},{name:"name1",type:"textarea",placeholder:"\u8acb\u63cf\u8ff0\u767c\u751f\u6b65\u9a5f"}],buttons:[{text:"\u9001\u51fa",cssClass:"primary uiFont",handler:function(){var e=Object(r.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(n.name0)){e.next=3;break}return t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u932f\u8aa4\uff0cE-mail \u4e0d\u7b26\u683c\u5f0f\uff01"}),e.abrupt("return");case 3:try{j.a.axiosInstance.post(j.a.bugReportApiUrl,{subject:"".concat(b.productName,"\u7570\u5e38\u8a18\u9304\u56de\u5831"),text:"E-mail: ".concat(n.name0,"\n\n\u767c\u751f\u6b65\u9a5f: ").concat(n.name1,"\n\n").concat(t.reportText)}),t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u6210\u529f"})}catch(s){console.error(s),t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u5931\u6557"})}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary uiFont",handler:function(){return t.setState({showBugReportAlert:!1})}}]})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.l,slot:"start"}),Object(m.jsx)("div",{className:"contentBlock",children:Object(m.jsxs)("div",{style:{flexDirection:"column"},children:[Object(m.jsx)(d.o,{className:"ion-text-wrap uiFont",children:"App \u8a2d\u5b9a"}),Object(m.jsxs)("div",{style:{textAlign:"right"},children:[Object(m.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(){var e=Object(r.a)(a.a.mark((function e(t){var n,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="data:text/json;charset=utf-8,".concat(encodeURIComponent(localStorage.getItem(j.a.storeFile)||"")),(s=document.createElement("a")).href=n,s.download=j.a.storeFile,s.click(),s.remove();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"\u532f\u51fa"}),Object(m.jsx)("input",{id:"importJsonInput",type:"file",accept:".json",style:{display:"none"},onChange:function(){var e=Object(r.a)(a.a.mark((function e(n){var s,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(s=n.target.files)||void 0===s?void 0:s.item(0),e.next=3,null===r||void 0===r?void 0:r.text();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0="";case 6:i=e.t0;try{JSON.parse(i),localStorage.setItem(j.a.storeFile,i),t.props.dispatch({type:"LOAD_SETTINGS"})}catch(a){console.error(a),console.error((new Error).stack)}document.getElementById("importJsonInput").value="";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object(m.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(e){document.querySelector("#importJsonInput").click()},children:"\u532f\u5165"}),Object(m.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(e){t.setState({showClearAlert:!0})},children:"\u91cd\u7f6e"}),Object(m.jsx)(d.a,{cssClass:"uiFont",isOpen:this.state.showClearAlert,backdropDismiss:!1,onDidPresent:function(e){},header:"\u91cd\u7f6e\u6703\u9084\u539f app \u8a2d\u5b9a\u9810\u8a2d\u503c\u4e26\u6e05\u9664\u66f8\u7c64\uff01\u78ba\u5b9a\u91cd\u7f6e\uff1f",buttons:[{text:"\u53d6\u6d88",cssClass:"primary uiFont",handler:function(e){t.setState({showClearAlert:!1})}},{text:"\u91cd\u7f6e",cssClass:"secondary uiFont",handler:function(){var e=Object(r.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.clearAppData();case 2:t.props.dispatch({type:"DEFAULT_SETTINGS"}),t.setState({showClearAlert:!1,showToast:!0,toastMessage:"\u6e05\u9664\u6210\u529f!"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]})]})]})})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.r,slot:"start"}),Object(m.jsxs)("div",{style:{width:"100%"},children:[Object(m.jsx)(d.o,{className:"ion-text-wrap uiFont",children:"\u66f4\u65b0\u96e2\u7dda\u8a8d\u990a\u52d5\u7269\u8cc7\u6599"}),Object(m.jsx)(d.t,{value:this.state.dataDownloadRatio})]}),Object(m.jsx)(d.c,{fill:"outline",shape:"round",slot:"end",size:"large",className:"uiFont",onClick:function(){var e=Object(r.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.updateOfflineData());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"\u66f4\u65b0"}),Object(m.jsx)(d.G,{cssClass:"uiFont",isOpen:this.state.showUpdateDataDone,onDidDismiss:function(){return t.setState({showUpdateDataDone:!1})},message:"\u96e2\u7dda\u8a8d\u990a\u52d5\u7269\u8cc7\u6599\u66f4\u65b0\u5b8c\u7562\uff01",duration:2e3})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.k,slot:"start"}),Object(m.jsx)(d.o,{className:"ion-text-wrap uiFont",children:j.a.appSettings.theme}),Object(m.jsxs)(d.z,{slot:"end",value:+this.props.theme,className:"uiFont",interface:"popover",interfaceOptions:{cssClass:"taathemes"},onIonChange:function(e){var n=+e.detail.value;+t.props.theme!==n&&t.props.dispatch({type:"SET_KEY_VAL",key:"theme",val:n})},children:[Object(m.jsx)(d.A,{className:"uiFont cbeta",value:0,children:"\u7da0\u5e95"}),Object(m.jsx)(d.A,{className:"uiFont dark",value:1,children:"\u6697\u8272"}),Object(m.jsx)(d.A,{className:"uiFont light",value:2,children:"\u4eae\u8272"}),Object(m.jsx)(d.A,{className:"uiFont oldPaper",value:3,children:"\u820a\u66f8"}),Object(m.jsx)(d.A,{className:"uiFont marble",value:4,children:"\u5927\u7406\u77f3"})]})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.z,slot:"start"}),Object(m.jsx)("div",{className:"contentBlock",children:Object(m.jsxs)("div",{style:{flexDirection:"column"},children:[Object(m.jsxs)(d.o,{className:"ion-text-wrap uiFont",children:[j.a.appSettings.uiFontSize,": ",this.props.uiFontSize]}),Object(m.jsx)(d.u,{min:12,max:32,pin:!0,snaps:!0,value:this.props.uiFontSize,onIonChange:function(n){t.props.dispatch({type:"SET_KEY_VAL",key:"uiFontSize",val:+n.detail.value}),e((function(){j.a.updateCssVars(t.props.settings)}))}})]})})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.z,slot:"start"}),Object(m.jsxs)("div",{className:"contentBlock",children:[Object(m.jsxs)(d.o,{className:"ion-text-wrap uiFont",children:[j.a.appSettings.textFontSize,": ",Object(m.jsx)("span",{className:"textFont",children:this.props.settings.textFontSize})]}),Object(m.jsx)(d.u,{min:12,max:64,pin:!0,snaps:!0,value:this.props.settings.textFontSize,onIonChange:function(n){t.props.dispatch({type:"SET_KEY_VAL",key:"textFontSize",val:+n.detail.value}),e((function(){j.a.updateCssVars(t.props.settings)}))}})]})]}),Object(m.jsxs)(d.k,{children:[Object(m.jsx)("div",{tabIndex:0}),Object(m.jsx)(d.f,{icon:f.m,slot:"start"}),Object(m.jsxs)("div",{className:"uiFont",children:[Object(m.jsx)("div",{children:"\u95dc\u65bc"}),Object(m.jsx)("div",{hidden:j.a.isMac(),children:Object(m.jsx)("a",{href:"https://github.com/MrMYHuang/taa",target:"_blank",rel:"noreferrer",children:"\u64cd\u4f5c\u8aaa\u660e\u8207\u958b\u653e\u539f\u59cb\u78bc"})}),Object(m.jsx)("div",{children:"\u4f5c\u8005: Meng-Yuan Huang"}),Object(m.jsx)("div",{children:Object(m.jsx)("a",{href:"mailto:myh@live.com",target:"_blank",rel:"noreferrer",children:"myh@live.com"})})]})]})]}),Object(m.jsx)(d.G,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return t.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),s}(p.a.Component),x=Object(d.T)(g);t.a=Object(h.b)((function(e){return{settings:e.settings,hasAppLog:e.settings.hasAppLog,theme:e.settings.theme,uiFontSize:e.settings.uiFontSize,speechRate:e.settings.speechRate,voiceURI:e.settings.voiceURI,mainVersion:e.tmpSettings.mainVersion}}))(x)}).call(this,n(53).setImmediate)},116:function(e,t,n){"use strict";(function(e){var s=n(18),a=n(6),r=n(7),i=n(8),o=n(9),c=n(1),l=n.n(c),u=n(2),p=n(22),d=n(13),h=n(5),j=n(61),f=n(0),b=h.a.isStoreApps()?Object(f.jsx)(f.Fragment,{}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"},children:Object(f.jsx)("a",{href:"https://github.com/MrMYHuang/twdi#web-app",target:"_blank",rel:"noreferrer",children:"\u7a0b\u5f0f\u5b89\u88dd\u8aaa\u660e"})}),Object(f.jsx)("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"},children:Object(f.jsx)("a",{href:"https://github.com/MrMYHuang/twdi#shortcuts",target:"_blank",rel:"noreferrer",children:"\u7a0b\u5f0f\u6377\u5f91"})})]}),m=function(t){Object(i.a)(c,t);var n=Object(o.a)(c);function c(e){var t;return Object(a.a)(this,c),(t=n.call(this,e)).bookmarkListRef=void 0,t.state={reorder:!1,showToast:!1,toastMessage:""},t.bookmarkListRef=l.a.createRef(),t}return Object(r.a)(c,[{key:"ionViewWillEnter",value:function(){this.hasBookmark||(this.setState({showToast:!0,toastMessage:"\u7121\u66f8\u7c64\uff01\u8acb\u81f3\u52d5\u7269\u8a73\u7d30\u8cc7\u6599\u65b0\u589e\u66f8\u7c64\u3002"}),this.props.history.push("".concat(h.a.pwaUrl,"/animals")))}},{key:"hasBookmark",get:function(){return this.props.settings.bookmarks.length>0}},{key:"delBookmarkHandler",value:function(t){var n=this;this.props.dispatch({type:"DEL_BOOKMARK",uuid:t}),e((function(){n.hasBookmark||(n.setState({showToast:!0,toastMessage:"\u7121\u66f8\u7c64\uff01\u8acb\u5c07\u4efb\u8a8d\u990a\u52d5\u7269\u52a0\u81f3\u66f8\u7c64\u3002"}),n.props.history.push("".concat(h.a.pwaUrl,"/animals")))}))}},{key:"reorderBookmarks",value:function(e){var t=e.detail.complete(this.props.settings.bookmarks);this.props.dispatch({type:"UPDATE_BOOKMARKS",bookmarks:t})}},{key:"getBookmarkRows",value:function(){var e=this,t=this.props.settings.bookmarks,n=Array();return t.forEach((function(t,a){var r=e.props.tmpSettings.animals.find((function(e){return e.animal_id===t}));n.push(Object(f.jsxs)(u.n,{children:[Object(f.jsxs)(u.k,{button:!0,onClick:function(n){return e.props.history.push("".concat(h.a.pwaUrl,"/animals/").concat(t))},children:[Object(f.jsx)("div",{tabIndex:0}),null==r?Object(f.jsx)(u.o,{className:"uiFont",children:"\u8cc7\u6599\u5eab\u5df2\u7121\u6b64\u52d5\u7269\uff0c\u8acb\u522a\u9664\u6b64\u9805\u76ee\u3002"}):Object(f.jsx)(j.a,Object(s.a)({},Object(s.a)({animal:r},e.props))),Object(f.jsx)(u.v,{slot:"end"})]},"bookmarkItem_"+a),Object(f.jsx)(u.m,{side:"end",children:Object(f.jsx)(u.l,{className:"uiFont",color:"danger",onClick:function(n){var s;e.delBookmarkHandler(t),null===(s=e.bookmarkListRef.current)||void 0===s||s.closeSlidingItems()},children:"\u522a\u9664"})})]},"bookmarkItemSliding_"+a))})),n}},{key:"render",value:function(){var e=this;return Object(f.jsxs)(u.s,{children:[Object(f.jsx)(u.e,{children:Object(f.jsxs)(u.I,{children:[Object(f.jsx)(u.F,{className:"uiFont",children:"\u66f8\u7c64"}),Object(f.jsx)(u.c,{fill:this.state.reorder?"solid":"clear",slot:"end",onClick:function(t){return e.setState({reorder:!e.state.reorder})},children:Object(f.jsx)(u.f,{icon:d.y,slot:"icon-only"})})]})}),Object(f.jsxs)(u.d,{children:[this.props.tmpSettings.isLoading?Object(f.jsx)(u.q,{cssClass:"uiFont",isOpen:this.props.tmpSettings.isLoading,message:"\u8f09\u5165\u4e2d..."}):this.hasBookmark?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(u.p,{ref:this.bookmarkListRef,children:Object(f.jsx)(u.w,{disabled:!this.state.reorder,onIonItemReorder:function(t){e.reorderBookmarks(t)},children:this.getBookmarkRows()})},"bookmarkList0"),b]}):Object(f.jsx)(f.Fragment,{}),Object(f.jsx)(u.G,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),c}(l.a.Component),g=Object(u.T)(m);t.a=Object(p.b)((function(e){return{bookmarks:e.settings.bookmarks,settings:e.settings,tmpSettings:e.tmpSettings}}))(g)}).call(this,n(53).setImmediate)},124:function(e,t,n){var s={"./ion-action-sheet.entry.js":[232,5],"./ion-alert.entry.js":[233,6],"./ion-app_8.entry.js":[234,7],"./ion-avatar_3.entry.js":[235,17],"./ion-back-button.entry.js":[236,18],"./ion-backdrop.entry.js":[237,43],"./ion-button_2.entry.js":[238,19],"./ion-card_5.entry.js":[239,20],"./ion-checkbox.entry.js":[240,21],"./ion-chip.entry.js":[241,22],"./ion-col_3.entry.js":[242,44],"./ion-datetime_3.entry.js":[243,10],"./ion-fab_3.entry.js":[244,23],"./ion-img.entry.js":[245,45],"./ion-infinite-scroll_2.entry.js":[246,46],"./ion-input.entry.js":[247,24],"./ion-item-option_3.entry.js":[248,25],"./ion-item_8.entry.js":[249,26],"./ion-loading.entry.js":[250,27],"./ion-menu_3.entry.js":[251,28],"./ion-modal.entry.js":[252,8],"./ion-nav_2.entry.js":[253,14],"./ion-popover.entry.js":[254,9],"./ion-progress-bar.entry.js":[255,29],"./ion-radio_2.entry.js":[256,30],"./ion-range.entry.js":[257,31],"./ion-refresher_2.entry.js":[258,11],"./ion-reorder_2.entry.js":[259,16],"./ion-ripple-effect.entry.js":[260,47],"./ion-route_4.entry.js":[261,32],"./ion-searchbar.entry.js":[262,33],"./ion-segment_2.entry.js":[263,34],"./ion-select_3.entry.js":[264,35],"./ion-slide_2.entry.js":[265,48],"./ion-spinner.entry.js":[266,13],"./ion-split-pane.entry.js":[267,49],"./ion-tab-bar_2.entry.js":[268,36],"./ion-tab_2.entry.js":[269,15],"./ion-text.entry.js":[270,37],"./ion-textarea.entry.js":[271,38],"./ion-toast.entry.js":[272,39],"./ion-toggle.entry.js":[273,12],"./ion-virtual-scroll.entry.js":[274,50]};function a(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(s)},a.id=124,e.exports=a},126:function(e,t,n){var s={"./ion-icon.entry.js":[275,57]};function a(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(s)},a.id=126,e.exports=a},172:function(e,t){},174:function(e,t){},206:function(e,t,n){},207:function(e,t,n){},228:function(e,t,n){},229:function(e,t,n){},230:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),r=n(33),i=n.n(r),o=n(58),c=n(4),l=n.n(c),u=n(10),p=n(18),d=n(6),h=n(7),j=n(8),f=n(9),b=n(14),m=n(2),g=n(110),x=n(22),O=n(111),v=n.n(O),k=n(51),y=n(34),w=n(5),S=function e(){Object(d.a)(this,e),this.version=1,this.hasAppLog=!0,this.theme=3,this.uiFontSize=24,this.textFontSize=24,this.dbUpdateDate="",this.bookmarks=[]};function _(e){for(;document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(e.theme),!0),w.a.updateCssVars(e)}var F=function e(){Object(d.a)(this,e),this.fetchError=!1,this.isLoading=!1,this.shareTextModal={text:"",show:!1},this.animals=[]};var A=Object(k.a)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S,t=arguments.length>1?arguments[1]:void 0,n=Object(p.a)({},e);switch(t.type){case"ADD_BOOKMARK":n.bookmarks=[].concat(Object(y.a)(n.bookmarks),[t.bookmark]),localStorage.setItem(w.a.storeFile,JSON.stringify({settings:n}));break;case"DEL_BOOKMARK":var s=n.bookmarks,a=s.findIndex((function(e){return e===t.uuid}));-1!==a&&s.splice(a,1),n.bookmarks=Object(y.a)(s),localStorage.setItem(w.a.storeFile,JSON.stringify({settings:n}));break;case"LOAD_SETTINGS":_(n=JSON.parse(localStorage.getItem(w.a.storeFile)).settings);break;case"SET_KEY_VAL":var r=t.key,i=t.val;switch(r){case"theme":document.body.classList.forEach((function(e){/theme/.test(e)&&document.body.classList.remove(e)})),document.body.classList.toggle("theme".concat(i),!0)}n[r]=i,localStorage.setItem(w.a.storeFile,JSON.stringify({settings:n}));break;case"UPDATE_BOOKMARKS":n.bookmarks=t.bookmarks,localStorage.setItem(w.a.storeFile,JSON.stringify({settings:n}));break;case"DEFAULT_SETTINGS":_(n=new S);break;default:0===Object.keys(n).length&&(n=new S);var o=new S;Object.keys(o).forEach((function(e){void 0===n[e]&&(n[e]=o[e])}))}return n},tmpSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new F,t=arguments.length>1?arguments[1]:void 0,n=Object(p.a)({},e),s=t.key,a=t.val;switch(n[s]=a,t.type){case"TMP_SET_KEY_VAL":return n}return e}});var T=n(13),C=(n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(114)),D=n(115),E=n(0),I=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(d.a)(this,n),(s=t.call(this,e)).state={isAppSettingsExport:Array(Object.keys(w.a.appSettings).length)},s}return Object(h.a)(n,[{key:"updateQrCode",value:function(){var e=this,t=Object.keys(w.a.appSettings).filter((function(t,n){return e.state.isAppSettingsExport[n]})).map((function(t,n){return{key:t,val:e.props.settings[t]}})).map((function(e){return"".concat(e.key,"=").concat(+e.val)})).join(",");t=""!==t?"settings=".concat(t):null;var n=this.props.text,s=/\?/.test(n);t&&(n+=s?"&".concat(t):"?".concat(t)),w.a.copyToClipboard(n);var a=document.getElementById("qrcCanvas");return D.toCanvas(a,n),a}},{key:"render",value:function(){var e=this;return Object(E.jsx)(m.r,{isOpen:this.props.showModal,cssClass:"uiFont",swipeToClose:!0,onWillPresent:function(){for(var t=[],n=0;n<e.state.isAppSettingsExport.length;n++)t.push(!1);e.setState({isAppSettingsExport:t},(function(){e.updateQrCode()}))},onDidDismiss:function(){return e.props.finish()},children:Object(E.jsx)(m.d,{children:Object(E.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center"},children:[Object(E.jsx)("div",{children:Object(E.jsx)(m.o,{className:"uiFont",children:"\u6b64\u9801app\u9023\u7d50\u5df2\u8907\u88fd\u81f3\u526a\u8cbc\u7c3f\uff01"})}),Object(E.jsx)("div",{children:Object(E.jsx)(m.o,{className:"uiFont",children:"\u4e5f\u53ef\u4ee5\u4f7f\u7528QR Code\u5206\u4eab:"})}),Object(E.jsx)("div",{style:{flexGrow:1,flexShrink:0,display:"flex",alignItems:"center",margin:10},children:Object(E.jsx)("canvas",{id:"qrcCanvas",width:"500",height:"500",style:{margin:"0px auto"}})}),Object(E.jsxs)("div",{children:[Object(E.jsx)(m.o,{className:"uiFont",children:"\u5305\u62ecapp\u8a2d\u5b9a:"}),Object(E.jsx)(m.p,{children:Object.keys(w.a.appSettings).map((function(t,n){return Object(E.jsxs)(m.k,{children:[Object(E.jsx)(m.o,{className:"ion-text-wrap uiFont",children:w.a.appSettings[t]}),Object(E.jsx)(m.H,{slot:"end",onIonChange:function(t){var s=e.state.isAppSettingsExport;s[n]=t.detail.checked,e.setState({isAppSettingsExport:s},(function(){e.updateQrCode()}))}})]},"appSettingExportItem_".concat(n))}))})]}),Object(E.jsx)("div",{children:Object(E.jsx)(m.c,{fill:"outline",shape:"round",size:"large",onClick:function(){return e.props.finish()},children:"\u95dc\u9589"})})]})})})}}]),n}(a.a.Component),L=Object(x.b)((function(e){return{settings:e.settings}}))(I),N=n(116),M=(n(228),n(61)),R=[{field:"\u985e\u578b",key:"animal_kind"},{field:"\u5730\u5740",key:"shelter_address"},{field:"\u6240\u5c6c\u6536\u5bb9\u6240\u540d\u7a31",key:"shelter_name"},{field:"\u6027\u5225",key:"animal_sex"},{field:"\u6bdb\u8272",key:"animal_colour"},{field:"\u9ad4\u578b",key:"animal_bodytype"},{field:"\u662f\u5426\u7d55\u80b2",key:"animal_sterilization"},{field:"\u662f\u5426\u65bd\u6253\u72c2\u72ac\u75c5\u75ab\u82d7",key:"animal_bacterin"},{field:"\u6d41\u6c34\u7de8\u865f",key:"animal_id"},{field:"\u5340\u57df\u7de8\u865f",key:"animal_subid"},{field:"\u806f\u7d61\u96fb\u8a71",key:"shelter_tel"},{field:"\u5be6\u969b\u6240\u5728\u5730",key:"animal_place"},{field:"\u5e74\u7d00",key:"animal_age"},{field:"\u5c0b\u7372\u5730",key:"animal_foundplace"},{field:"\u72c0\u614b",key:"animal_status"},{field:"\u958b\u653e\u8a8d\u990a\u6642\u9593(\u8d77)",key:"animal_opendate"},{field:"\u958b\u653e\u8a8d\u990a\u6642\u9593(\u8fc4)",key:"animal_closeddate"},{field:"\u8cc7\u6599\u7570\u52d5\u6642\u9593",key:"animal_update"},{field:"\u8cc7\u6599\u5efa\u7acb\u6642\u9593",key:"animal_createtime"}],B=function e(){Object(d.a)(this,e),this.id=0,this.key="animal_kind",this.search=""},U=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(d.a)(this,n),(s=t.call(this,e)).animalsFiltered=[],s.filterRegExp=[],s.page=0,s.rows=20,s.state={animalsLoaded:[],filtersSel:[new B],isScrollOn:!1,showToast:!1,toastMessage:""},s.fetachDataPageByPage(!0),s}return Object(h.a)(n,[{key:"fetachDataPageByPage",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,s,a=this,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.next=3,new Promise((function(e,t){var n=setInterval((function(){a.props.tmpSettings.isLoading||(0===a.animalsFiltered.length&&0===a.filterRegExp.length&&(a.animalsFiltered=a.props.tmpSettings.animals),clearInterval(n),e())}),50)}));case 3:return t&&(this.page=0),console.log("Loading page ".concat(this.page)),n=this.animalsFiltered.length,s=new Array(this.rows).fill(0).map((function(e){return a.animalsFiltered[Math.floor(Math.random()*n)]})).filter((function(e){return null!=e})),this.page+=1,this.setState({animalsLoaded:t?s:[].concat(Object(y.a)(this.state.animalsLoaded),Object(y.a)(s)),isScrollOn:this.state.animalsLoaded.length<n}),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectDetail",value:function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.history.push("".concat(w.a.pwaUrl,"/").concat(this.props.match.params.tab,"/").concat(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderFilterRows",value:function(){var e=this;return this.state.filtersSel.map((function(t,n){return Object(E.jsxs)(m.k,{className:"uiFont",children:[Object(E.jsx)(m.o,{className:"uiFont",children:"\u689d\u4ef6\uff1a"}),Object(E.jsx)(m.z,{value:e.state.filtersSel[n].id,className:"uiFont ionSelect",interface:"popover",onIonChange:function(t){var s=+t.detail.value;if(+e.state.filtersSel[n].id!==s){var a=e.state.filtersSel;a[n].id=s,a[n].key=R[s].key,e.setState({filtersSel:a})}},children:R.map((function(e,t){return Object(E.jsx)(m.A,{className:"uiFont",value:t,children:e.field},"selOpt".concat(t))}))}),Object(E.jsx)(m.o,{className:"uiFont",children:"\u7b26\u5408\uff1a"}),Object(E.jsx)(m.j,{value:e.state.filtersSel[n].search,className:"ionInput",clearInput:!0,onIonChange:function(t){var s=e.state.filtersSel;s[n].search=t.detail.value||"",e.setState({filtersSel:s})}}),Object(E.jsx)(m.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(t){e.state.filtersSel.splice(n,1),e.setState({filtersSel:e.state.filtersSel})},children:"\u522a\u9664"})]},"filterRow".concat(n))}))}},{key:"renderRows",value:function(){var e=this;return this.state.animalsLoaded.map((function(t,n){return Object(E.jsx)(m.k,{className:"textFont",button:!0,onClick:function(n){e.selectDetail(t.animal_id)},children:Object(E.jsx)(M.a,Object(p.a)({},Object(p.a)({animal:t},e.props)))},"item".concat(n))}))}},{key:"render",value:function(){var e=this;return this.props.tmpSettings.isLoading?Object(E.jsx)(m.q,{cssClass:"uiFont",isOpen:this.props.tmpSettings.isLoading,message:"\u8f09\u5165\u4e2d..."}):Object(E.jsxs)(m.s,{children:[Object(E.jsx)(m.e,{children:Object(E.jsxs)(m.I,{children:[Object(E.jsx)(m.F,{className:"uiFont",children:"\u8a8d\u990a\u52d5\u7269"}),Object(E.jsx)(m.c,{fill:"clear",slot:"end",onClick:function(t){e.props.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!0,text:decodeURIComponent(window.location.href)}})},children:Object(E.jsx)(m.f,{icon:T.x,slot:"icon-only"})})]})}),Object(E.jsxs)(m.d,{style:{textAlign:"center"},children:[Object(E.jsx)(m.p,{children:this.renderFilterRows()}),Object(E.jsx)(m.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(t){e.state.filtersSel.push(new B),e.setState({filtersSel:e.state.filtersSel})},children:"\u65b0\u589e\u689d\u4ef6"}),Object(E.jsx)(m.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(t){e.filterRegExp=e.state.filtersSel.map((function(t,n){return new RegExp(".*".concat(e.state.filtersSel[n].search,".*"))})),e.animalsFiltered=e.props.tmpSettings.animals.filter((function(t){for(var n=!0,s=0;s<e.filterRegExp.length;s++){if(""!==e.state.filtersSel[s].search){var a=e.state.filtersSel[s].key,r=e.filterRegExp[s].test(t[a]);n=n&&r}}return n})),e.fetachDataPageByPage(!0)},children:"\u641c\u5c0b"}),Object(E.jsxs)(m.p,{children:[this.renderRows(),Object(E.jsx)(m.h,{threshold:"100px",disabled:!this.state.isScrollOn,onIonInfinite:function(t){e.fetachDataPageByPage(),t.target.complete()},children:Object(E.jsx)(m.i,{loadingText:"\u8f09\u5165\u4e2d..."})})]}),Object(E.jsx)(m.G,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),n}(a.a.Component),z=Object(m.T)(U),P=Object(x.b)((function(e){return{tmpSettings:e.tmpSettings,settings:e.settings}}))(z),K=(n(229),[{field:"\u985e\u578b",key:"animal_kind"},{field:"\u6027\u5225",key:"animal_sex"},{field:"\u9ad4\u578b",key:"animal_bodytype"},{field:"\u6bdb\u8272",key:"animal_colour"},{field:"\u5e74\u7d00",key:"animal_age"},{field:"\u72c0\u614b",key:"animal_status"},{field:"\u662f\u5426\u7d55\u80b2",key:"animal_sterilization"},{field:"\u662f\u5426\u65bd\u6253\u72c2\u72ac\u75c5\u75ab\u82d7",key:"animal_bacterin"},{field:"\u6d41\u6c34\u7de8\u865f",key:"animal_id"},{field:"\u5340\u57df\u7de8\u865f",key:"animal_subid"},{field:"\u6240\u5c6c\u6536\u5bb9\u6240\u540d\u7a31",key:"shelter_name"},{field:"\u5730\u5740",key:"shelter_address"},{field:"\u806f\u7d61\u96fb\u8a71",key:"shelter_tel"},{field:"\u5c0b\u7372\u5730",key:"animal_foundplace"},{field:"\u5be6\u969b\u6240\u5728\u5730",key:"animal_place"},{field:"\u958b\u653e\u8a8d\u990a\u6642\u9593(\u8d77)",key:"animal_opendate"},{field:"\u958b\u653e\u8a8d\u990a\u6642\u9593(\u8fc4)",key:"animal_closeddate"},{field:"\u8cc7\u6599\u7570\u52d5\u6642\u9593",key:"animal_update"},{field:"\u8cc7\u6599\u5efa\u7acb\u6642\u9593",key:"animal_createtime"},{field:"\u6240\u5c6c\u7e23\u5e02\u4ee3\u78bc",key:"animal_area_pkid"},{field:"\u6240\u5c6c\u6536\u5bb9\u6240\u4ee3\u78bc",key:"animal_shelter_pkid"},{field:"\u7db2\u9801\u6a19\u984c",key:"animal_title"},{field:"\u8cc7\u6599\u5099\u8a3b",key:"animal_remark"},{field:"\u5176\u4ed6\u8aaa\u660e",key:"animal_caption"},{field:"\u5716\u7247\u540d\u7a31(\u539f\u59cb\u540d\u7a31)",key:"album_name"},{field:"\u7570\u52d5\u6642\u9593",key:"cDate"}]),V=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(d.a)(this,n),(s=t.call(this,e)).state={showToast:!1,toastMessage:""},s}return Object(h.a)(n,[{key:"animal",get:function(){var e=this;return this.props.tmpSettings.animals.find((function(t){return t.animal_id===+e.props.match.params.animalId}))}},{key:"addBookmarkHandler",value:function(){var e;this.props.dispatch({type:"ADD_BOOKMARK",bookmark:null===(e=this.animal)||void 0===e?void 0:e.animal_id}),this.setState({showToast:!0,toastMessage:"\u66f8\u7c64\u65b0\u589e\u6210\u529f\uff01"})}},{key:"render",value:function(){var e,t=this,n=[];if(null!=this.animal){n=[];for(var s=0;s<K.length;s++)n.push(Object(E.jsx)(m.k,{className:"textFont",children:K[s].field+"\uff1a"+this.animal[K[s].key]},s))}return this.props.tmpSettings.isLoading?Object(E.jsx)(m.q,{cssClass:"uiFont",isOpen:this.props.tmpSettings.isLoading,message:"\u8f09\u5165\u4e2d..."}):Object(E.jsxs)(m.s,{children:[Object(E.jsx)(m.e,{children:Object(E.jsxs)(m.I,{children:[Object(E.jsx)(m.c,{fill:"clear",slot:"start",onClick:function(e){return t.props.history.goBack()},children:Object(E.jsx)(m.f,{icon:T.a,slot:"icon-only"})}),Object(E.jsx)(m.F,{className:"uiFont",children:"\u8a73\u7d30\u8cc7\u8a0a"}),Object(E.jsx)(m.c,{fill:"clear",slot:"end",onClick:function(e){t.addBookmarkHandler()},children:Object(E.jsx)(m.f,{icon:T.c,slot:"icon-only"})}),Object(E.jsx)(m.c,{fill:"clear",slot:"end",onClick:function(e){t.props.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!0,text:decodeURIComponent(window.location.href)}})},children:Object(E.jsx)(m.f,{icon:T.x,slot:"icon-only"})})]})}),Object(E.jsxs)(m.d,{style:{textAlign:"center"},children:[null==this.animal?Object(E.jsx)(m.o,{className:"ion-text-wrap textFont",children:"\u6b64\u8a8d\u990a\u52d5\u7269\u8cc7\u6599\u5df2\u4e0d\u5b58\u5728\u3002"}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(m.g,{src:(null===(e=this.animal)||void 0===e?void 0:e.album_file)||"",className:"detailScreenImg",alt:""}),Object(E.jsx)(m.p,{children:n})]}),Object(E.jsx)(m.G,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return t.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),n}(a.a.Component),Y=Object(m.T)(V),J=Object(x.b)((function(e){return{tmpSettings:e.tmpSettings,settings:e.settings}}))(Y),G=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var s;return Object(d.a)(this,n),(s=t.call(this,e)).state={},s}return Object(h.a)(n,[{key:"render",value:function(){return Object(E.jsx)(m.r,{isOpen:this.props.showModal,cssClass:"uiFont",backdropDismiss:!1,swipeToClose:!1,children:Object(E.jsx)(m.d,{children:Object(E.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center"},children:[Object(E.jsxs)(m.o,{className:"ion-text-wrap uiFont",children:[this.props.item,"\u4e0b\u8f09\u4e2d\uff0c\u8acb\u7b49\u5f85\u3002"]}),Object(E.jsx)(m.t,{style:{height:"40px"},value:this.props.progress/100}),Object(E.jsxs)(m.o,{className:"ion-text-wrap uiFont",children:[Math.floor(this.props.progress),"%"]})]})})})}}]),n}(a.a.Component),H=Object(x.b)((function(e){return{}}))(G),W=window.electronBackendApi,q=function(){var e=localStorage.getItem(w.a.storeFile);return null!=e?Object(k.b)(A,JSON.parse(e)):Object(k.b)(A)}();Object(m.S)({mode:"md",swipeBackEnabled:!1});var Q={onSuccess:function(e){},onUpdate:function(e){}},$=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(E.jsx)(x.a,{store:q,children:Object(E.jsx)(Z,Object(p.a)({},this.props))})}}]),n}(a.a.Component),X=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(e){var s;for(Object(d.a)(this,n),(s=t.call(this,e)).registrationNew=void 0,s.originalAppSettingsStr=void 0,s.wakeLock=void 0,s.props.settings.hasAppLog||w.a.disableAppLog(),null===W||void 0===W||W.receive("fromMain",(function(e){switch(e.event){case"version":q.dispatch({type:"TMP_SET_KEY_VAL",key:"mainVersion",val:e.version})}})),null===W||void 0===W||W.send("toMain",{event:"ready"}),s.registrationNew=null;document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(s.props.settings.theme),!0);var a=v.a.parse(s.props.location.search);return a.settings&&(s.originalAppSettingsStr=localStorage.getItem(w.a.storeFile),a.settings.split(",").forEach((function(e){var t=e.split("=");s.props.dispatch({type:"SET_KEY_VAL",key:t[0],val:+t[1]})}))),w.a.updateCssVars(s.props.settings),s.state={showUpdateAlert:!1,showRestoreAppSettingsToast:null!=a.settings&&null!=s.originalAppSettingsStr||!1,showToast:!1,toastMessage:"",downloadModal:{progress:0,show:!1}},Q.onUpdate=function(e){s.registrationNew=e,s.setState({showUpdateAlert:!0})},Q.onSuccess=function(e){},"undefined"!==typeof speechSynthesis&&(speechSynthesis.getVoices(),speechSynthesis.cancel()),navigator.wakeLock&&(s.wakeLockScreen(),document.addEventListener("visibilitychange",Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"visible"===document.visibilityState?s.wakeLockScreen():s.wakeLockScreenRelease();case 1:case"end":return e.stop()}}),e)}))))),indexedDB.open(w.a.database).onupgradeneeded=function(e){e.target.result.createObjectStore("store"),console.log("DB store created.")},s.loadData(),s}return Object(h.a)(n,[{key:"restoreAppSettings",value:function(){localStorage.setItem(w.a.storeFile,this.originalAppSettingsStr),this.props.dispatch({type:"LOAD_SETTINGS"})}},{key:"loadData",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,s,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q.dispatch({type:"TMP_SET_KEY_VAL",key:"isLoading",val:!0}),t="\u52d5\u7269\u8a8d\u990a\u8cc7\u6599",e.prev=2,e.next=5,w.a.getFileFromIndexedDB(w.a.animalsKey);case 5:n=e.sent,e.next=17;break;case 8:return e.prev=8,e.t0=e.catch(2),this.setState({downloadModal:{item:t,show:!0,progress:0}}),e.next=13,w.a.downloadData(w.a.dataUrl,(function(e){a.setState({downloadModal:{item:t,show:!0,progress:e}})}));case 13:s=e.sent,n=JSON.parse(s.toString()),this.setState({downloadModal:{item:t,show:!1,progress:100}}),w.a.saveFileToIndexedDB(w.a.animalsKey,n);case 17:q.dispatch({type:"TMP_SET_KEY_VAL",key:"animals",val:n}),q.dispatch({type:"TMP_SET_KEY_VAL",key:"isLoading",val:!1});case 19:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"wakeLockScreen",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==(t=navigator.wakeLock)){e.next=9;break}return e.next=5,t.request("screen");case 5:this.wakeLock=e.sent,console.log("Screen wake lock is requested."),e.next=10;break;case 9:console.error("navigator.wakeLock is undefined.");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("".concat(e.t0.name,", ").concat(e.t0.message)),console.log((new Error).stack);case 16:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"wakeLockScreenRelease",value:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.wakeLock){e.next=5;break}return e.next=3,this.wakeLock.release();case 3:this.wakeLock=null,console.log("Screen wake lock is released.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"routeByQueryString",value:function(){console.log(window.location.search);var e=/route=([^&]*)/.exec(window.location.search),t=/query=([^&]*)/.exec(window.location.search);if(null!==e){var n=decodeURIComponent(e[1]),s="";return null!==t&&(s=decodeURIComponent(t[1])),Object(E.jsx)(b.a,{to:n+s})}if(window.location.pathname==="".concat(w.a.pwaUrl)||window.location.pathname==="".concat(w.a.pwaUrl,"/"))return Object(E.jsx)(b.a,{to:"".concat(w.a.pwaUrl,"/bookmarks")})}},{key:"render",value:function(){var e,t,n=this;return Object(E.jsxs)(m.b,{children:[Object(E.jsx)(g.a,{children:Object(E.jsxs)(m.D,{children:[Object(E.jsxs)(m.y,{animated:!1,children:[Object(E.jsx)(b.b,{path:"".concat(w.a.pwaUrl,"/:tab(bookmarks)"),render:function(e){return Object(E.jsx)(N.a,Object(p.a)({},e))},exact:!0}),Object(E.jsx)(b.b,{path:"".concat(w.a.pwaUrl,"/:tab(animals)"),render:function(e){return Object(E.jsx)(P,Object(p.a)({},e))},exact:!0}),Object(E.jsx)(b.b,{path:"".concat(w.a.pwaUrl,"/:tab(animals)/:animalId"),render:function(e){return Object(E.jsx)(J,Object(p.a)({},e))},exact:!0}),Object(E.jsx)(b.b,{path:"".concat(w.a.pwaUrl,"/settings"),render:function(e){return Object(E.jsx)(C.a,Object(p.a)({},e))}}),Object(E.jsx)(b.b,{path:"".concat(w.a.pwaUrl,"/"),render:function(){return n.routeByQueryString()},exact:!0})]}),Object(E.jsxs)(m.B,{slot:"bottom",children:[Object(E.jsx)(m.C,{tab:"bookmarks",href:"".concat(w.a.pwaUrl,"/bookmarks"),children:Object(E.jsx)(m.f,{icon:T.c})}),Object(E.jsx)(m.C,{tab:"animals",href:"".concat(w.a.pwaUrl,"/animals"),children:Object(E.jsx)(m.f,{icon:T.o})}),Object(E.jsx)(m.C,{tab:"settings",href:"".concat(w.a.pwaUrl,"/settings"),children:Object(E.jsx)(m.f,{icon:T.w})})]})]})}),Object(E.jsx)(m.a,{cssClass:"uiFont",isOpen:this.state.showUpdateAlert,backdropDismiss:!1,onDidPresent:function(e){var t,s,a,r;null===(t=n.registrationNew)||void 0===t||null===(s=t.installing)||void 0===s||s.postMessage({type:"SKIP_WAITING"}),null===(a=n.registrationNew)||void 0===a||null===(r=a.waiting)||void 0===r||r.postMessage({type:"SKIP_WAITING"})},header:"App \u5df2\u66f4\u65b0\uff0c\u8acb\u91cd\u555f!",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(e){n.setState({showUpdateAlert:!1})}}]}),Object(E.jsx)(H,Object(p.a)({},Object(p.a)({item:this.state.downloadModal.item,progress:this.state.downloadModal.progress,showModal:this.state.downloadModal.show},this.props))),Object(E.jsx)(L,Object(p.a)({},Object(p.a)({text:null===(e=this.props.shareTextModal)||void 0===e?void 0:e.text,showModal:(null===(t=this.props.shareTextModal)||void 0===t?void 0:t.show)||!1,finish:function(){q.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!1}})}},this.props))),Object(E.jsx)(m.G,{cssClass:"uiFont",isOpen:this.state.showRestoreAppSettingsToast,onDidDismiss:function(){return n.setState({showRestoreAppSettingsToast:!1})},message:"\u5df2\u5957\u7528 app \u9023\u7d50\u4e2d\u7684\u8a2d\u5b9a\uff0c\u662f\u5426\u9084\u539f\u8a2d\u5b9a\uff1f",buttons:[{text:"\u53d6\u6d88",role:"cancel",handler:function(){return n.setState({showRestoreAppSettingsToast:!1})}},{text:"\u9084\u539f",handler:function(){return n.restoreAppSettings()}}]}),Object(E.jsx)(m.G,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return n.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})}}]),n}(a.a.Component),Z=Object(x.b)((function(e){return{shareTextModal:e.tmpSettings.shareTextModal,settings:e.settings}}))(X),ee=Object(b.f)($),te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ne(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){console.log("installingWorker stage changed: ".concat(n.state)),"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}w.a.enableAppLog(),i.a.render(Object(E.jsx)(o.a,{children:Object(E.jsx)(ee,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/taa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/taa","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var s=n.headers.get("content-type");404===n.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ne(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ne(t,e)}))}}({onSuccess:function(e){console.log("Precache app loaded!"),Q.onSuccess(e)},onUpdate:function(e){console.log("Found app updated!"),Q.onUpdate(e)}})},5:function(e,t,n){"use strict";var s=n(4),a=n.n(s),r=n(10),i=n(112),o=n.n(i),c=n(74),l=n.n(c),u=n(2),p=n(113),d=n(0),h="/taa",j="taaDb",f=o.a.create({timeout:8e3});function b(){return(b=Object(r.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){var a=new p.DownloaderHelper(t,".",{}),r=!0;a.on("progress",(function(e){r&&(n(e.progress),r=!1,setTimeout((function(){r=!0}),100))})),a.on("end",(function(t){a.removeAllListeners();var n=l.a.readFileSync(t.filePath);e(n)})),a.start()})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=Object(r.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=indexedDB.open(j),e.abrupt("return",new Promise((function(e,s){n.onsuccess=function(){var i=Object(r.a)(a.a.mark((function i(o){var c,l,u;return a.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:c=n.result;try{l=c.transaction(["store"],"readwrite"),(u=l.objectStore("store").get(t)).onsuccess=function(){var n=Object(r.a)(a.a.mark((function n(r){var i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=u.result){n.next=5;break}return console.error("".concat(t," loading failed!")),console.error((new Error).stack),n.abrupt("return",s());case 5:return n.abrupt("return",e(i));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}catch(o){console.error(o)}case 2:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(r.a)(a.a.mark((function e(t,n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=indexedDB.open(j),e.abrupt("return",new Promise((function(e,i){s.onsuccess=function(){var o=Object(r.a)(a.a.mark((function r(o){var c,l,u;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c=s.result,l=c.transaction(["store"],"readwrite"),(u=l.objectStore("store").put(n,t)).onsuccess=function(t){return e()},u.onerror=function(e){return i()};case 5:case"end":return a.stop()}}),r)})));return function(e){return o.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(r.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=indexedDB.open(j),e.abrupt("return",new Promise((function(e,s){try{n.onsuccess=function(a){var r=n.result.transaction(["store"],"readwrite");try{var i=r.objectStore("store").delete(t);i.onsuccess=function(t){return e()},i.onerror=function(e){return s()}}catch(o){console.error(o)}}}catch(a){s(a)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(r.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=indexedDB.open(j),e.abrupt("return",new Promise((function(e,n){t.onsuccess=function(){var s=Object(r.a)(a.a.mark((function s(r){var i,o,c;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:i=t.result,o=i.transaction(["store"],"readwrite"),(c=o.objectStore("store").clear()).onsuccess=function(t){return e()},c.onerror=function(e){return n()};case 5:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v="";function k(){return(k=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=console.log.bind(console),w=console.error.bind(console);function S(){return Object(u.R)("ios")&&"MacIntel"===navigator.platform}var _={pwaUrl:h,axiosInstance:f,dataUrl:"https://data.coa.gov.tw/Service/OpenData/TransService.aspx?UnitId=QcbUEzN6E6DL",bugReportApiUrl:"https://vh6ud1o56g.execute-api.ap-northeast-1.amazonaws.com/bugReportMailer",database:j,downloadData:function(e,t){return b.apply(this,arguments)},getFileFromIndexedDB:function(e){return m.apply(this,arguments)},saveFileToIndexedDB:function(e,t){return g.apply(this,arguments)},removeFileFromIndexedDB:function(e){return x.apply(this,arguments)},clearIndexedDB:function(){return O.apply(this,arguments)},animalsKey:"animals",storeFile:"taaSettings.json",getLog:function(){return v},enableAppLog:function(){console.log=function(){v+="----- Info ----\n",v+=Array.from(arguments)+"\n",y.apply(console,arguments)},console.error=function(){v+="----- Error ----\n",v+=Array.from(arguments)+"\n",w.apply(console,arguments)}},disableAppLog:function(){v="",console.log=y,console.error=w},appSettings:{theme:"\u4f48\u666f\u4e3b\u984c",uiFontSize:"UI \u5b57\u578b\u5927\u5c0f",textFontSize:"\u5167\u5bb9\u6587\u5b57\u5927\u5c0f"},fetchErrorContent:Object(d.jsx)("div",{className:"contentCenter",children:Object(d.jsx)(u.o,{children:Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{children:"\u9023\u7dda\u5931\u6557!"}),Object(d.jsxs)("div",{style:{fontSize:"var(--ui-font-size)",paddingTop:24},children:["\u8acb\u5617\u8a66\u9ede\u64ca\u53f3\u4e0a\u65b9\u7684\u91cd\u65b0\u8b80\u53d6\u6309\u9215\u3002\u5982\u679c\u554f\u984c\u6301\u7e8c\u767c\u751f\uff0c\u8acb\u57f7\u884c",Object(d.jsx)("a",{href:"/".concat(h,"/settings"),target:"_self",children:"\u8a2d\u5b9a\u9801"}),"\u7684 app \u7570\u5e38\u56de\u5831\u529f\u80fd\u3002"]})]})})}),updateApp:function(){return new Promise(function(){var e=Object(r.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.serviceWorker.getRegistrations().then(function(){var e=Object(r.a)(a.a.mark((function e(n){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.update().then((function(e){return null!==e.installing||null!==e.waiting}))})));case 2:s=e.sent,t(s.reduce((function(e,t){return e||t}),!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},updateCssVars:function(e){document.documentElement.style.cssText="--text-font-size: ".concat(e.textFontSize,"px; --ui-font-size: ").concat(e.uiFontSize,"px;")},isMacCatalyst:S,isTouchDevice:function(){return Object(u.R)("ios")&&!S()||Object(u.R)("android")},isStoreApps:function(){return Object(u.R)("pwa")||Object(u.R)("electron")},isMac:function(){return"MacIntel"===navigator.platform},clearAppData:function(){return k.apply(this,arguments)},copyToClipboard:function(e){try{navigator.clipboard&&navigator.clipboard.writeText(e)}catch(t){console.error(t)}}};t.a=_},61:function(e,t,n){"use strict";var s=n(6),a=n(7),r=n(8),i=n(9),o=n(1),c=n.n(o),l=n(2),u=n(22),p=n(0),d=["\u6027\u5225","\u5e74\u7d00","\u958b\u653e\u8a8d\u990a\u6642\u9593(\u8d77)","\u6240\u5c6c\u6536\u5bb9\u6240\u540d\u7a31","\u7570\u52d5\u6642\u9593"],h=["animal_sex","animal_age","animal_opendate","shelter_name","cDate"],j=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){for(var e=[],t=0;t<h.length;t++)e.push(Object(p.jsxs)("div",{children:["\u2022 ",d[t]+"\uff1a"+this.props.animal[h[t]]]},"text".concat(t)));var n=this.props.animal.album_file;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(l.E,{slot:"start",className:"animalCellImg",children:Object(p.jsx)(l.g,{src:n,alt:""})}),Object(p.jsx)(l.o,{className:"ion-text-wrap",children:e})]})}}]),n}(c.a.Component);t.a=Object(u.b)((function(e){return{tmpSettings:e.tmpSettings,settings:e.settings}}))(j)},63:function(e){e.exports=JSON.parse('{"name":"taa","homepage":"/taa","productName":"Taiwan Animal Adoption","pwaVersion":"2.3.2","version":"2.1.0","license":"MIT","keywords":["\u52d5\u7269\u8a8d\u990a","\u53f0\u7063"],"description":"\u96a8\u6a5f\u5448\u73fe\u53f0\u7063\u5f85\u8a8d\u990a\u52d5\u7269\u8cc7\u8a0a","repository":"https://github.com/MrMYHuang/taa","author":{"name":"Meng-Yuan Huang","email":"myh@live.com"},"private":false,"files":["README.md"],"main":"buildElectron/main.js","scripts":{"postinstall":"electron-builder install-app-deps","start":"react-app-rewired start","build":"react-app-rewired build && powershell -file CopyBuild.ps1","build_linux":"react-app-rewired build && ./CopyBuild.sh","test":"react-app-rewired test","eject":"react-scripts eject","build-electron":"tsc -b tsconfigElectron.json","build-electron-store":"tsc -b tsconfigElectron.json && mv buildElectron/mainStore.js buildElectron/main.js","start-electron":"npm run build-electron && electron .","dist-snap":"npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap -c electronBuilderConfigs/snap.json -c.extraMetadata.name=twaa","dist-snap-arm64":"export SNAPCRAFT_BUILD_ENVIRONMENT=lxd && npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap --arm64 -c electronBuilderConfigs/snap.json -c.extraMetadata.name=twaa","publish-snap":"snapcraft upload --release=stable dist/*.snap","icons-mas":"cd buildElectron && iconutil -c icns icon.iconset","dist-mas":"npm run build-electron-store && electron-builder -m mas --universal -c electronBuilderConfigs/mas.json","dist-mas-dev":"npm run build-electron-store && electron-builder -m mas-dev --arm64 -c electronBuilderConfigs/masDev.json"},"dependencies":{"axios":"^0.21.1","electron-window-state":"^5.0.3","node-downloader-helper":"^1.0.18","react":"^17.0.2","react-dom":"^17.0.2","react-test-renderer":"16.2.0"},"devDependencies":{"@ionic/react":"^5.6.12","@ionic/react-router":"^5.6.12","@testing-library/jest-dom":"^5.14.1","@testing-library/react":"^11.2.7","@testing-library/user-event":"^12.8.3","@types/adm-zip":"^0.4.34","@types/jest":"^26.0.24","@types/node":"^12.20.16","@types/qrcode":"^1.4.1","@types/react":"^16.14.11","@types/react-dom":"^16.9.14","@types/react-redux":"^7.1.18","@types/react-router":"^5.1.16","@types/react-router-dom":"^5.1.8","@types/uuid":"^8.3.1","customize-cra":"^1.0.0","electron":"^11.4.10","electron-builder":"^22.11.7","electron-builder-notarize-pkg":"^1.2.0","history":"^4.10.1","ionicons":"^5.5.2","memfs":"^3.2.0","qrcode":"^1.4.4","query-string":"^6.14.1","react":"^17.0.2","react-app-rewired":"^2.1.7","react-dom":"^17.0.2","react-redux":"^7.2.4","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^4.0.3","redux":"^4.1.0","typescript":"^4.3.5","uuid":"^8.3.1","workbox-background-sync":"^5.1.3","workbox-broadcast-update":"^5.1.3","workbox-cacheable-response":"^5.1.3","workbox-core":"^5.1.3","workbox-expiration":"^5.1.3","workbox-google-analytics":"^5.1.3","workbox-navigation-preload":"^5.1.3","workbox-precaching":"^5.1.3","workbox-range-requests":"^5.1.3","workbox-routing":"^5.1.3","workbox-strategies":"^5.1.3","workbox-streams":"^5.1.3"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')}},[[230,3,4]]]);
//# sourceMappingURL=main.3c5697d5.chunk.js.map